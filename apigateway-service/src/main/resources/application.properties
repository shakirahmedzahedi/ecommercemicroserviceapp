# =========================
# Application
# =========================
spring.application.name=APIGATEWAY-SERVICE
server.port=8081
spring.main.web-application-type=reactive

# =========================
# Eureka Service Discovery
# =========================
eureka.client.service-url.defaultZone=http://localhost:8761/eureka
eureka.client.register-with-eureka=true
eureka.client.fetch-registry=true

# Force Eureka registration to use IP instead of machine hostname
eureka.instance.prefer-ip-address=true
eureka.instance.ip-address=127.0.0.1
eureka.instance.hostname=localhost
eureka.instance.non-secure-port=${server.port}
eureka.instance.appname=${spring.application.name}
eureka.instance.status-page-url=http://localhost:${server.port}/actuator/health
eureka.instance.health-check-url=http://localhost:${server.port}/actuator/health

# =========================
# Gateway Routes
# =========================
spring.cloud.gateway.server.webflux.routes[0].id=product-service
spring.cloud.gateway.server.webflux.routes[0].uri=lb://PRODUCT-SERVICE
spring.cloud.gateway.server.webflux.routes[0].predicates[0]=Path=/api/v1/product/**

spring.cloud.gateway.server.webflux.routes[1].id=cart-service
spring.cloud.gateway.server.webflux.routes[1].uri=lb://CART-SERVICE
spring.cloud.gateway.server.webflux.routes[1].predicates[0]=Path=/api/v1/cart/**

spring.cloud.gateway.server.webflux.routes[2].id=order-service
spring.cloud.gateway.server.webflux.routes[2].uri=lb://ORDER-SERVICE
spring.cloud.gateway.server.webflux.routes[2].predicates[0]=Path=/api/v1/order/**

# =========================
# Springdoc OpenAPI Swagger UI Aggregation
# =========================
springdoc.swagger-ui.enabled=true
springdoc.swagger-ui.path=/swagger-ui.html

# Aggregated service docs via gateway
springdoc.swagger-ui.urls[0].name=Product Service
springdoc.swagger-ui.urls[0].url=http://localhost:8081/api/v1/product/v3/api-docs

springdoc.swagger-ui.urls[1].name=Cart Service
springdoc.swagger-ui.urls[1].url=http://localhost:8081/api/v1/cart/v3/api-docs

springdoc.swagger-ui.urls[2].name=Order Service
springdoc.swagger-ui.urls[2].url=http://localhost:8081/api/v1/order/v3/api-docs
